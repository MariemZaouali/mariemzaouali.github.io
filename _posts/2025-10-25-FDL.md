---
layout: post
title: FDL assessment
tags: [NVIDIA, FDL, TechXdays]
author: Mariem ZAOUALI
---
# Guide de l'examen de certification FDL

## Accès à la page de l'évènement

Accédez à 
```python
https://learn.nvidia.com/dli-event
```

Entrez le code suivant:

````python
PSOUSSE_FDL_AMBASSADOR_OC25
```


## Etape 1: Chargement du modèle
```python
from torchvision.models import vgg16
from torchvision.models import VGG16_Weights

weights = VGG16_Weights.DEFAULT  # FIXME
vgg_model = vgg16(weights=weights)
```

## Etape 2: Gêler le modèle

```python
# Freeze base model
vgg_model.requires_grad_(False) #FIXME
next(iter(vgg_model.parameters())).requires_grad
```

## Etape 3: Affecter le nombre de classe
```python
N_CLASSES = 6 #FIXME

my_model = nn.Sequential(
    vgg_model.features,
    vgg_model.avgpool,
    nn.Flatten(),
    vgg_model.classifier[0:3],
    nn.Linear(4096, 500),
    nn.ReLU(),
    nn.Linear(500, N_CLASSES)
)
my_model
```

## Etape 4: Préciser la fonction de perte loss
```python
loss_function = nn.CrossEntropyLoss() #FIXME
optimizer = Adam(my_model.parameters())
my_model = torch.compile(my_model.to(device))
```

## Etape 5: Data Augmentation
```python

IMG_WIDTH, IMG_HEIGHT = 224, 224

random_trans = transforms.Compose([
transforms.RandomRotation(5),
transforms.RandomResizedCrop((IMG_WIDTH, IMG_HEIGHT), scale=(.9, 1), ratio=(1,
transforms.RandomHorizontalFlip(),
transforms.ColorJitter(brightness=.1, contrast=.1, saturation=.1, hue=.1)
])
```

## Etape 6: Batch et dataLoader

```python
n = 32 #FIXME

train_path = "data/fruits/train/"
train_data = MyDataset(train_path)
train_loader = DataLoader(train_data, batch_size=n, shuffle=True)#FIXME
train_N = len(train_loader.dataset)

valid_path = "data/fruits/valid/"
valid_data = MyDataset(valid_path)
valid_loader = DataLoader(valid_data, batch_size=n, shuffle=False)#FIXME
valid_N = len(valid_loader.dataset)
```

## Etape 7: Lancer le modèle et suivre la précision de la validation
